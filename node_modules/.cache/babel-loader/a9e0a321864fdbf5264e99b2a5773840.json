{"ast":null,"code":"import _defineProperty from\"/Users/dannylee/git/ttp-live/ttp-live-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/dannylee/git/ttp-live/ttp-live-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/dannylee/git/ttp-live/ttp-live-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/dannylee/git/ttp-live/ttp-live-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/dannylee/git/ttp-live/ttp-live-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/dannylee/git/ttp-live/ttp-live-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import axios from'axios';var commaNumber=require('comma-number');var HEADERS={\"content-type\":\"application/json\",\"accept\":\"application/json\"};var RightCol=/*#__PURE__*/function(_Component){_inherits(RightCol,_Component);function RightCol(props){var _this;_classCallCheck(this,RightCol);_this=_possibleConstructorReturn(this,_getPrototypeOf(RightCol).call(this,props));_this.handleChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;_this.setState(_defineProperty({},name,value));};_this.handleSubmit=function(event){event.preventDefault();var _this$state=_this.state,ticker=_this$state.ticker,quantity=_this$state.quantity;// check for completed form inputs\nif(!ticker){alert(\"Please enter a valid stock ticker symbol.\");return;}// positive, integers only\nif(!quantity||!Number.isInteger(Number(quantity))||quantity<0){alert(\"Please enter quantity of shares\");return;}axios.get(\"https://sandbox.iexapis.com/stable/stock/\".concat(ticker,\"/quote?token=Tpk_f60d00f3b3774527b14ddc2510d54b18\")).then(function(response){if(response.data.symbol){var orderCost=(response.data.latestPrice*quantity).toFixed(2);var newBalance=_this.props.user.cash-orderCost;if(newBalance>0){_this.setState({ticker:'',quantity:''});_this.placeOrder(_this.props.user.id,newBalance,ticker,quantity,response.data.latestPrice);}else{alert(\"Insufficient funds\");return;}}else{_this.setState({errors:'no such ticker',ticker:'',quantity:''});}}).catch(function(error){console.log('api errors:',error);alert('Please enter a valid stock ticker symbol');});};_this.state={ticker:'',quantity:''};return _this;}_createClass(RightCol,[{key:\"placeOrder\",value:function placeOrder(userID,newBalance,ticker,quantity,latestPrice){var _this2=this;fetch(\"https://ttp-live-backend.herokuapp.com/users/\".concat(userID),{method:\"PATCH\",headers:HEADERS,body:JSON.stringify({cash:newBalance})}).then(function(resp){return resp.json();}).then(function(json){_this2.props.updateUser(json.user);});fetch(\"https://ttp-live-backend.herokuapp.com/stocks\",{method:\"POST\",headers:HEADERS,body:JSON.stringify({symbol:ticker.toUpperCase(),shares:quantity,price:latestPrice,user_id:userID})}).then(function(resp){return resp.json();}).then(function(json){_this2.props.updateStocks(json.stock,latestPrice);});}},{key:\"render\",value:function render(){// console.log(this.props)\nvar _this$state2=this.state,ticker=_this$state2.ticker,quantity=_this$state2.quantity;return(// Portfolio mode, show right column bg color and dividing line\nReact.createElement(\"div\",{className:\"column \".concat(this.props.modeStatus==='portfolio'?'right':'')},this.props.modeStatus==='portfolio'?React.createElement(React.Fragment,null,React.createElement(\"div\",{className:\"cash-balance\"},\"Cash Balance: $ \",this.props.userobj?\"\".concat(commaNumber(parseFloat(this.props.userobj.cash).toFixed(2))):null),React.createElement(\"br\",null),React.createElement(\"div\",null,React.createElement(\"form\",{className:\"w3-container stock-form\",onSubmit:this.handleSubmit},React.createElement(\"input\",{placeholder:\"Ticker symbol\",className:\"w3-input w3-border w3-light-grey\",type:\"text\",name:\"ticker\",value:ticker,onChange:this.handleChange}),React.createElement(\"br\",null),React.createElement(\"input\",{placeholder:\"Quantity\",className:\"w3-input w3-border w3-light-grey\",type:\"text\",name:\"quantity\",value:quantity,onChange:this.handleChange}),React.createElement(\"br\",null),React.createElement(\"button\",{className:\"w3-btn w3-round-large w3-blue-grey\",placeholder:\"submit\",type:\"submit\"},\"Buy\")))):null));}}]);return RightCol;}(Component);export default RightCol;","map":{"version":3,"sources":["/Users/dannylee/git/ttp-live/ttp-live-frontend/src/components/RightCol.js"],"names":["React","Component","axios","commaNumber","require","HEADERS","RightCol","props","handleChange","event","target","name","value","setState","handleSubmit","preventDefault","state","ticker","quantity","alert","Number","isInteger","get","then","response","data","symbol","orderCost","latestPrice","toFixed","newBalance","user","cash","placeOrder","id","errors","catch","error","console","log","userID","fetch","method","headers","body","JSON","stringify","resp","json","updateUser","toUpperCase","shares","price","user_id","updateStocks","stock","modeStatus","userobj","parseFloat"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios'\n\nvar commaNumber = require('comma-number')\n\nconst HEADERS = {\n  \"content-type\": \"application/json\",\n  \"accept\"      : \"application/json\"\n}\n\nclass RightCol extends Component {\n\n  constructor (props) {\n    super(props);\n    this.state = { \n      ticker: '',\n      quantity: ''\n    };\n  }\n\n  handleChange = (event) => {\n    const {name, value} = event.target\n    this.setState({\n      [name]: value\n    })\n  };\n\n  placeOrder(userID, newBalance, ticker, quantity, latestPrice) {\n    fetch(`https://ttp-live-backend.herokuapp.com/users/${userID}`, {\n      method: \"PATCH\",\n      headers: HEADERS,\n      body: JSON.stringify({\n        cash: newBalance\n      })\n    })\n    .then(resp => resp.json())\n    .then(json => {\n      this.props.updateUser(json.user)\n    })\n    fetch(`https://ttp-live-backend.herokuapp.com/stocks`, {\n      method: \"POST\",\n      headers: HEADERS,\n      body: JSON.stringify({\n        symbol: ticker.toUpperCase(),\n        shares: quantity,\n        price: latestPrice,\n        user_id: userID\n      })\n    })\n    .then(resp => resp.json())\n    .then(json => {\n      this.props.updateStocks(json.stock, latestPrice)\n    })\n  }\n\n  handleSubmit = (event) => {\n    event.preventDefault()\n    const {ticker, quantity} = this.state\n\n    // check for completed form inputs\n    if (!ticker) {\n      alert(\"Please enter a valid stock ticker symbol.\")\n      return\n    }\n    // positive, integers only\n    if (!quantity || !Number.isInteger(Number(quantity)) || quantity < 0) {\n      alert(\"Please enter quantity of shares\")\n      return\n    }\n\n    axios.get(`https://sandbox.iexapis.com/stable/stock/${ticker}/quote?token=Tpk_f60d00f3b3774527b14ddc2510d54b18`)\n    .then(response => {\n      if (response.data.symbol) {\n        let orderCost = (response.data.latestPrice * quantity).toFixed(2)\n        let newBalance = this.props.user.cash - orderCost\n        if (newBalance > 0 ) {\n          this.setState({\n            ticker: '',\n            quantity: ''\n          })\n          this.placeOrder(this.props.user.id, newBalance, ticker, quantity, response.data.latestPrice)\n        } else {\n          alert(\"Insufficient funds\")\n          return\n        }\n      } else {\n        this.setState({\n          errors: 'no such ticker',\n          ticker: '',\n          quantity: ''\n        })\n      }\n    })\n    .catch(error => {\n      console.log('api errors:', error)\n      alert('Please enter a valid stock ticker symbol')\n    })\n  };\n\n  render() {\n    // console.log(this.props)\n    const {ticker, quantity} = this.state\n    return (\n      // Portfolio mode, show right column bg color and dividing line\n      <div className={`column ${(this.props.modeStatus === 'portfolio') ? 'right' : ''}`}>\n        {this.props.modeStatus === 'portfolio' ? \n        <>\n          <div className=\"cash-balance\">\n            Cash Balance: $ {this.props.userobj ? `${commaNumber(parseFloat(this.props.userobj.cash).toFixed(2))}` : null}\n          </div>\n          <br />\n          <div>\n            <form className=\"w3-container stock-form\" onSubmit={this.handleSubmit}>\n              <input\n                placeholder=\"Ticker symbol\"\n                className=\"w3-input w3-border w3-light-grey\"\n                type=\"text\"\n                name=\"ticker\"\n                value={ticker}\n                onChange={this.handleChange}\n              />\n              <br />\n              <input\n                  placeholder=\"Quantity\"\n                  className=\"w3-input w3-border w3-light-grey\"\n                  type=\"text\"\n                  name=\"quantity\"\n                  value={quantity}\n                  onChange={this.handleChange}\n              />\n              <br />\n              <button className=\"w3-btn w3-round-large w3-blue-grey\" placeholder=\"submit\" type=\"submit\">\n                Buy\n              </button>\n            </form>\n          </div>\n        </>\n        : null}\n      </div>\n    )\n  }\n}\n\nexport default RightCol;\n"]},"metadata":{},"sourceType":"module"}