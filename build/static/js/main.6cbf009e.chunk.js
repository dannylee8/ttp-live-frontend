(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{36:function(e,t,a){e.exports=a(63)},63:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(33),s=a.n(o),l=a(19),c=a(22),i=a(6),u=a(7),p=a(9),d=a(8),m=a(10),h=a(13),g=a(14),b=a(5),f=a.n(b),E=a(12),v=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(E.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n={username:t.username,email:t.email,password:t.password,password_confirmation:t.password_confirmation,cash:5e3};f.a.post("https://ttp-live-backend.herokuapp.com/users",{user:n},{withCredentials:!0}).then((function(e){"created"===e.data.status?(a.props.handleLogin(e.data),a.redirect()):a.setState({errors:e.data.errors,username:"",email:"",password:"",password_confirmation:""})})).catch((function(e){return console.log("api errors:",e)}))},a.redirect=function(){a.props.history.push("/")},a.handleErrors=function(){return r.a.createElement("div",null,r.a.createElement("ul",{className:"error-message"},a.state.errors.map((function(e){return r.a.createElement("li",{key:e},e)}))))},a.state={username:"",email:"",password:"",password_confirmation:"",errors:""},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){return this.props.loggedInStatus?this.redirect():null}},{key:"render",value:function(){var e=this.state,t=e.username,a=e.email,n=e.password,o=e.password_confirmation;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"top-menu"},r.a.createElement("span",{className:"logo"},"TTP Stock Trade")),r.a.createElement("div",{className:"center"},r.a.createElement("div",{id:"login_div"},r.a.createElement("h4",null,"Register"),r.a.createElement("form",{className:"w3-container",onSubmit:this.handleSubmit},r.a.createElement("input",{placeholder:"username",className:"w3-input w3-border w3-light-grey",type:"text",name:"username",value:t,onChange:this.handleChange}),r.a.createElement("input",{placeholder:"email",className:"w3-input w3-border w3-light-grey",type:"text",name:"email",value:a,onChange:this.handleChange}),r.a.createElement("input",{placeholder:"password",className:"w3-input w3-border w3-light-grey",type:"password",name:"password",value:n,onChange:this.handleChange}),r.a.createElement("input",{placeholder:"password confirmation",className:"w3-input w3-border w3-light-grey",type:"password",name:"password_confirmation",value:o,onChange:this.handleChange}),r.a.createElement("button",{className:"w3-btn w3-round-large w3-blue-grey",placeholder:"submit",type:"submit"},"Sign Up"),r.a.createElement("div",null,"or ",r.a.createElement(h.b,{to:"/login"},"login"))),r.a.createElement("br",null)),r.a.createElement("div",{className:"error-box"},this.state.errors?this.handleErrors():null)))}}]),t}(n.Component),w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(E.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n={email:t.email,password:t.password};f.a.post("https://ttp-live-backend.herokuapp.com/login",{user:n},{withCredentials:!0}).then((function(e){e.data.logged_in?(a.props.handleLogin(e.data),a.redirect()):a.setState({errors:e.data.errors,email:"",password:""})})).catch((function(e){return console.log("api errors:",e)}))},a.redirect=function(){a.props.history.push("/")},a.handleErrors=function(){return r.a.createElement("div",null,r.a.createElement("ul",{className:"error-message"},a.state.errors.map((function(e){return r.a.createElement("li",{key:e},e)}))))},a.state={email:"",password:"",errors:""},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){return console.log(this.props.loggedInStatus),this.props.loggedInStatus?this.redirect():null}},{key:"render",value:function(){var e=this.state,t=e.email,a=e.password;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"top-menu"},r.a.createElement("span",{className:"logo"},"TTP Stock Trade")),r.a.createElement("div",{className:"center"},r.a.createElement("div",{id:"login_div"},r.a.createElement("h4",null,"Sign In"),r.a.createElement("form",{className:"w3-container",onSubmit:this.handleSubmit},r.a.createElement("input",{placeholder:"email",className:"w3-input w3-border w3-light-grey",type:"text",name:"email",value:t,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("input",{placeholder:"password",className:"w3-input w3-border w3-light-grey",type:"password",name:"password",value:a,onChange:this.handleChange}),r.a.createElement("button",{className:"w3-btn w3-round-large w3-blue-grey",placeholder:"submit",type:"submit"},"Log In"),r.a.createElement("div",null,"or ",r.a.createElement(h.b,{to:"/signup"},"register")))),r.a.createElement("div",{className:"error-box"},this.state.errors?this.handleErrors():null)))}}]),t}(n.Component);var y=function(e){var t=function(t){e.setMode(t.target.innerHTML.toLowerCase())};return r.a.createElement("div",{className:"w3-bar top-menu"},r.a.createElement("span",{className:"logo"},"TTP Stock Trade"),e.loggedInStatus?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.b,{to:"/logout",onClick:function(){f.a.delete("https://ttp-live-backend.herokuapp.com/logout",{withCredentials:!0}).then((function(t){e.handleLogout(),e.history.push("/login")})).catch((function(e){return console.log(e)}))}},r.a.createElement("button",{className:"w3-bar-item w3-button w3-pale-blue w3-right w3-hover-pale-red"},r.a.createElement("span",{className:"glyphicon glyphicon-log-out"})," Log Out")),r.a.createElement("button",{onClick:t,className:"w3-bar-item w3-button w3-light-grey w3-right w3-hover-pale-red"},"Portfolio"),r.a.createElement("button",{onClick:t,className:"w3-bar-item w3-button w3-sand w3-right w3-hover-pale-red"},"Transactions")):null)},k=a(18);var S=function(e){return console.log(e),r.a.createElement("tr",null,r.a.createElement("td",{className:e.currentPrice>e.openPrice?"green":e.currentPrice===e.openPrice?"gray":"red"},e.symbol),r.a.createElement("td",null,e.shares," shares"),r.a.createElement("td",{className:e.currentPrice>e.openPrice?"green":e.currentPrice===e.openPrice?"gray":"red"},"$ ",k((e.shares*e.currentPrice).toFixed(2))))};var j=function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,"BUY (",e.symbol,")"),r.a.createElement("td",null,e.shares," shares @ $",parseFloat(e.price).toFixed(2)))},O=a(18);var C=function(e){return r.a.createElement("div",{className:"column left"},r.a.createElement("br",null),r.a.createElement("br",null),"portfolio"===e.modeStatus?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Portfolio"),r.a.createElement("h4",null,"Current value: $",O(e.portfolioCurrentValue.toFixed(2))),r.a.createElement("h4",null,"Portfolio Cost: $",O(e.portfolioCost)),r.a.createElement("table",{id:"stocks"},r.a.createElement("tbody",null,e.stocks.map((function(e){return r.a.createElement(S,{key:e.id,symbol:e.symbol,shares:e.shares,currentPrice:e.current_price,openPrice:e.openPrice})}))))):r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Transactions"),r.a.createElement("table",{id:"stocks"},r.a.createElement("tbody",null,e.stocks.map((function(e){return r.a.createElement(j,{key:e.id,symbol:e.symbol,shares:e.shares,price:e.price})}))))))},N=a(18),P={"content-type":"application/json",accept:"application/json"},L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(E.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.ticker,r=t.quantity;n?!r||!Number.isInteger(Number(r))||r<0?alert("Please enter quantity of shares"):f.a.get("https://sandbox.iexapis.com/stable/stock/".concat(n,"/quote?token=Tpk_f60d00f3b3774527b14ddc2510d54b18")).then((function(e){if(e.data.symbol){var t=(e.data.latestPrice*r).toFixed(2),o=a.props.user.cash-t;if(!(o>0))return void alert("Insufficient funds");a.setState({ticker:"",quantity:""}),a.placeOrder(a.props.user.id,o,n,r,e.data.latestPrice)}else a.setState({errors:"no such ticker",ticker:"",quantity:""})})).catch((function(e){console.log("api errors:",e),alert("Please enter a valid stock ticker symbol")})):alert("Please enter a valid stock ticker symbol.")},a.state={ticker:"",quantity:""},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"placeOrder",value:function(e,t,a,n,r){var o=this;fetch("https://ttp-live-backend.herokuapp.com/users/".concat(e),{method:"PATCH",headers:P,body:JSON.stringify({cash:t})}).then((function(e){return e.json()})).then((function(e){o.props.updateUser(e.user)})),fetch("https://ttp-live-backend.herokuapp.com/stocks",{method:"POST",headers:P,body:JSON.stringify({symbol:a.toUpperCase(),shares:n,price:r,user_id:e})}).then((function(e){return e.json()})).then((function(e){o.props.updateStocks(e.stock,r)}))}},{key:"render",value:function(){var e=this.state,t=e.ticker,a=e.quantity;return(r.a.createElement("div",{className:"column ".concat("portfolio"===this.props.modeStatus?"right":"")},"portfolio"===this.props.modeStatus?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"cash-balance"},"Cash Balance: $ ",this.props.userobj?"".concat(N(parseFloat(this.props.userobj.cash).toFixed(2))):null),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("form",{className:"w3-container stock-form",onSubmit:this.handleSubmit},r.a.createElement("input",{placeholder:"Ticker symbol",className:"w3-input w3-border w3-light-grey",type:"text",name:"ticker",value:t,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("input",{placeholder:"Quantity",className:"w3-input w3-border w3-light-grey",type:"text",name:"quantity",value:a,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("button",{className:"w3-btn w3-round-large w3-blue-grey",placeholder:"submit",type:"submit"},"Buy")))):null))}}]),t}(n.Component),I=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).redirect=function(){a.props.history.push("/login")},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){return this.props.loggedInStatus?null:this.redirect()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(y,Object.assign({},this.props,{setMode:this.props.setMode,loggedInStatus:this.props.loggedInStatus})),this.props.loggedInStatus?r.a.createElement("div",{className:"row"},r.a.createElement(C,Object.assign({},this.props,{userobj:this.props.userobj,modeStatus:this.props.modeStatus})),r.a.createElement(L,Object.assign({},this.props,{updateUser:this.props.updateUser,userobj:this.props.userobj,modeStatus:this.props.modeStatus}))):null)}}]),t}(n.Component),x=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).setMode=function(e){a.setState({mode:e})},a.updateUser=function(e){a.setState({user:e})},a.updateStocks=function(e,t){a.setState({stocks:[].concat(Object(c.a)(a.state.stocks),[Object(l.a)({},e,{current_price:t})])})},a.loginStatus=function(){f.a.get("https://ttp-live-backend.herokuapp.com/logged_in",{withCredentials:!0}).then((function(e){e.data.logged_in?a.handleLogin(e.data):a.handleLogout()})).catch((function(e){console.log("api errors:",e)}))},a.handleLogin=function(e){a.setState((function(t,a){return{isLoggedIn:!0,user:e.user,mode:"portfolio"}})),e.user&&a.getUserStocks(e.user.id)},a.getUserStocks=function(e){fetch("https://ttp-live-backend.herokuapp.com/users/".concat(e)).then((function(e){return e.json()})).then((function(e){a.setState((function(t,a){return{stocks:e.stocks,portfolioCost:e.portfolio_cost,portfolioCurrentValue:e.portfolio_current_value}}));var t=e.stocks.map((function(e){return e.symbol})).join(",");f.a.get("https://sandbox.iexapis.com/stable/stock/market/batch?symbols=".concat(t,"&types=ohlc&token=Tpk_f60d00f3b3774527b14ddc2510d54b18")).then((function(e){var t=function(){var t=n,r=a.state.stocks.find((function(e){return e.symbol===t})),o=a.state.stocks.filter((function(e){return e.symbol!==t})),s=e.data[n].ohlc.open.price;a.setState({stocks:[].concat(Object(c.a)(o),[Object(l.a)({},r,{openPrice:s})])})};for(var n in e.data)t()}))}))},a.handleLogout=function(){a.setState({isLoggedIn:!1,user:{}})},a.state={isLoggedIn:!1,loading:!0,mode:"",portfolioCost:0,portfolioCurrentValue:0,stocks:[],user:{}},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.loginStatus()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"wrapper"},r.a.createElement(h.a,null,r.a.createElement(g.c,null,r.a.createElement(g.a,{exact:!0,path:"/login",render:function(t){return r.a.createElement(w,Object.assign({},t,{handleLogin:e.handleLogin,loggedInStatus:e.state.isLoggedIn}))}}),r.a.createElement(g.a,{exact:!0,path:"/signup",render:function(t){return r.a.createElement(v,Object.assign({},t,{handleLogin:e.handleLogin,loggedInStatus:e.state.isLoggedIn}))}}),r.a.createElement(g.a,{path:"/",render:function(t){return r.a.createElement(I,Object.assign({},t,e.state,{updateUser:e.updateUser,updateStocks:e.updateStocks,handleLogout:e.handleLogout,userobj:e.state.user,setMode:e.setMode,modeStatus:e.state.mode,loggedInStatus:e.state.isLoggedIn}))}}))))}}]),t}(n.Component);s.a.render(r.a.createElement(x,null),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.6cbf009e.chunk.js.map